<ul>
    {% for item in menu_items %}
        <li{% if request.path == item.url or request.resolver_match.url_name == item.named_url %} class="active"{% endif %}>
            <a href="{% if item.named_url %}{% url item.named_url %}{% else %}{{ item.url }}{% endif %}">
                {{ item.title }}
            </a>
            {% if item.children.all %}
                <ul>
                    {% for child in item.children.all %}
                        <li{% if request.path == child.url or request.resolver_match.url_name == child.named_url %} class="active"{% endif %}>
                            <a href="{% if child.named_url %}{% url child.named_url %}{% else %}{{ child.url }}{% endif %}">
                                {{ child.title }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
</ul>
